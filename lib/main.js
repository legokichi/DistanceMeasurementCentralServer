// Generated by CoffeeScript 1.10.0
var Chord, changeColor, chord, main, rootNodeId, setup;

window.navigator["getUserMedia"] = window.navigator.webkitGetUserMedia || window.navigator.mozGetUserMedia || window.navigator.getUserMedia;

Chord = P2PRingNet.Chord;

chord = null;

rootNodeId = null;

setup = function(next) {
  chord = new Chord({
    host: location.hostname,
    port: location.port,
    path: "peerjs",
    secure: true,
    debug: 3
  });
  window["chord"] = chord;
  return next();
};

main = function(next) {
  if (rootNodeId) {
    ord.join(rootNodeId);
  } else {
    chord.create();
  }
  return next();
};

changeColor = function() {
  return document.body.style.backgroundColor = location.hash.slice(1);
};

window.addEventListener("DOMContentLoaded", function() {
  return setup(function() {
    return main(function() {
      return changeColor();
    });
  });
});

window.addEventListener("hashchange", changeColor);
